---
layout: post
title: "ä»£ç æäº¤æ£€æŸ¥"
date: 2020-05-27
author: ZZChaser
# cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-banner.png'
tags: engineering
---

> `husky` + `lint-staged`

## `husky`: Git hooks made easy ğŸ¶ woof!

&emsp;&emsp;æ³¨å†Œ`git hooks`, åœ¨`.git/hooks`æ–‡ä»¶å¤¹ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯æ³¨å†Œçš„`hooks`

- `pre-commit`: `commit`å‰æ‰§è¡Œçš„å‡½æ•°ï¼Œå¯ç”¨äºæ£€æŸ¥ä»£ç è§„èŒƒ
- `commit-msg`: å¯éªŒè¯æäº¤çš„çš„æè¿°è§„èŒƒ

### ä½¿ç”¨

1. å®‰è£…

```text
$ npm install -D husky

```

2. é…ç½®`package.json`

```json
{
  // ...
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS",
      "pre-commit": "lint-staged"
    }
  }
}
```

## `lint-staged`: Run linters on git staged files

&emsp;&emsp;åªåœ¨`staged`æš‚å­˜çš„æ–‡ä»¶ä¸­è¿è¡Œ`linter`

### ä½¿ç”¨

1. å®‰è£…

```text
$ npm i -D lint-staged

```

2. é…ç½®`package.json`

```json
{
  // ...
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS",
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "src/**/*.{tsx,ts}": ["eslint --ext .tsx,.ts", "git add"]
  }
}
```

## `@commitlint/cli + @commitlint/config-angular`: éªŒè¯æäº¤è§„èŒƒ

&emsp;&emsp;`@commitlint/config-angular`ä¸º angular å›¢é˜Ÿæäº¤è§„èŒƒ

### ä½¿ç”¨

1. å®‰è£…

```text
$ npm i -D @commitlint/cli @commitlint/config-angular
```

2. é…ç½®`package.json` å’Œ `commitlint.config.js`

```json
{
  // ...
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  }
}
```

```js
module.exports = {
  extends: ["@commitlint/config-angular"],
  rules: {
    // ..é…ç½®æ£€æŸ¥è§„åˆ™
  },
};
```

3.

## å‚è€ƒ

- <a style='color:#0A497B' href='https://www.jianshu.com/p/dd07cca0a48e' target='_blank'>ESLint+Prettier ä»£ç è§„èŒƒå®è·µ</a>
- <a style='color:#0A497B' href='https://segmentfault.com/a/1190000017790694' target='_blank'>å‰ç«¯ä»£ç é£æ ¼è‡ªåŠ¨åŒ–ç³»åˆ—ï¼ˆäºŒï¼‰ä¹‹ Commitlint</a>
